# ======================= 基础工程配置 =======================

cmake_minimum_required(VERSION 3.20)                                    # 指定 CMake 最低版本为 3.20
project(datastructlearning LANGUAGES C CXX)                                    # 定义工程名称 datastructlearning，启用 C 与 C++


# ======================= 语言标准设置 =======================

set(CMAKE_C_STANDARD 17)                                                # 设置 C 语言标准为 C17
set(CMAKE_C_STANDARD_REQUIRED ON)                                       # 要求编译器必须支持 C17
set(CMAKE_CXX_STANDARD 23)                                              # 设置 C++ 语言标准为 C++23
set(CMAKE_CXX_STANDARD_REQUIRED ON)                                     # 要求编译器必须支持 C++23


# ======================= 构建类型 & 编译数据库 =======================

if(NOT CMAKE_BUILD_TYPE)                                                # 如果没有手动指定构建类型
    set(CMAKE_BUILD_TYPE Debug CACHE STRING "Build type" FORCE)         # 默认设为 Debug 模式（方便调试）
endif()
 
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)                                   # 生成 compile_commands.json，方便 VSCode / clangd 智能分析


# ======================= 路径相关 =======================

set(PROJECT_ROOT "${CMAKE_SOURCE_DIR}")                                 # 项目根目录，即 DATASTRUCTLEARNING
set(SRC_DIR      "${PROJECT_ROOT}/src")                                 # 源码目录 src
set(INCLUDE_DIR  "${SRC_DIR}/include")                                  # 头文件目录 src/include
set(LIB_DIR      "${SRC_DIR}/lib")                                      # 库源码目录 src/lib
set(RESOURCE_DIR "${PROJECT_ROOT}/resources")                           # 资源目录 resources（图片/配置文件等）
set(THIRD_PARTY_DIR "${SRC_DIR}/third_party")                           # 第三方库目录 src/third_party

# ======================= 输出目录设置 =======================

set(CMAKE_RUNTIME_OUTPUT_DIRECTORY "${PROJECT_ROOT}/bin")               # 指定可执行文件输出到 bin/ 目录


# ======================= 源文件列表（C++ / C 分开列） =======================

set(CPP_SOURCE_FILES                                                    # C++ 源文件列表
    #"${SRC_DIR}/main.cpp"                                               # 主程序入口文件
    #"${LIB_DIR}/arithmetic.cpp"                                         # arithmetic 功能模块
    #"${LIB_DIR}/menu.cpp"                                               # menu 功能模块
    #"${LIB_DIR}/ui.cpp"                                                 # ui 功能模块
    # 可在此继续添加更多 C++ 文件，例如：
    # "${LIB_DIR}/list.cpp"                                             # list 数据结构
    # "${LIB_DIR}/tree.cpp"                                             # tree 数据结构
)

set(C_SOURCE_FILES                                                      # C 源文件列表（目前为空，未来可扩展）
    "${SRC_DIR}/main.c"
    "${LIB_DIR}/ui.c"
    "${LIB_DIR}/pointdata.c"
    "${LIB_DIR}/common_operations.c"

    # ===== SQLite 源码 =====
    "${THIRD_PARTY_DIR}/sqlite3.c"   

)

set(SOURCE_FILES                                                        # 统一整合 C 和 C++ 源文件
    ${CPP_SOURCE_FILES}
    ${C_SOURCE_FILES}
)


# ======================= 生成可执行文件目标 =======================

add_executable(datastructlearning                                       # 定义生成可执行文件 datastructlearning
    ${SOURCE_FILES}                                                     # 指定所有源文件
)

target_include_directories(datastructlearning                           # 设置头文件搜索路径
    PRIVATE
        "${INCLUDE_DIR}"                                                # 让 #include 可以找到 src/include 下的头文件
        "${THIRD_PARTY_DIR}"                                            # 让 #include "sqlite3.h" 能被找到
)


# ======================= 编译选项（对 C 和 C++ 都生效） =======================

target_compile_options(datastructlearning                                      # 添加编译器警告选项
    PRIVATE
        -Wall                                                           # 打开常规警告
        -Wextra                                                         # 打开额外警告
        -Wpedantic                                                      # 严格遵循 C/C++ 标准的警告
)


# ======================= 资源目录宏（可选） =======================

target_compile_definitions(datastructlearning                                  # 添加预处理宏定义
    PRIVATE
        RESOURCE_DIR="${RESOURCE_DIR}"                                  # 定义资源目录绝对路径，在代码中可直接使用 RESOURCE_DIR
)
